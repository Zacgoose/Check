{
  "type": "object",
  "properties": {
    "showNotifications": {
      "title": "Show Notifications",
      "description": "Display security notifications and warnings",
      "type": "boolean",
      "default": true
    },
    "enableValidPageBadge": {
      "title": "Show Valid Page Badge",
      "description": "Display validation badge on legitimate Microsoft login pages",
      "type": "boolean",
      "default": true
    },
    "validPageBadgeTimeout": {
      "title": "Valid Page Badge Timeout (seconds)",
      "description": "Auto-dismiss timeout for the valid page badge in seconds. Set to 0 for no timeout (badge stays visible until manually dismissed).",
      "type": "integer",
      "minimum": 0,
      "maximum": 300,
      "default": 5
    },
    "enablePageBlocking": {
      "title": "Page Blocking Enabled",
      "description": "Enable blocking of malicious pages",
      "type": "boolean",
      "default": true
    },
    "enableCippReporting": {
      "title": "CIPP Reporting Enabled",
      "description": "Enable reporting to CIPP server",
      "type": "boolean",
      "default": false
    },
    "cippServerUrl": {
      "title": "CIPP Server URL",
      "description": "Base URL for CIPP reporting server",
      "type": "string",
      "format": "uri",
      "default": ""
    },
    "cippTenantId": {
      "title": "CIPP Tenant ID/Domain",
      "description": "Tenant identifier to include with CIPP alerts for multi-tenant environments",
      "type": "string",
      "default": ""
    },
    "customRulesUrl": {
      "title": "Custom Rules URL",
      "description": "URL to fetch custom detection rules from",
      "type": "string",
      "format": "uri",
      "default": ""
    },
    "updateInterval": {
      "title": "Update Interval (hours)",
      "description": "How often to update detection rules in hours",
      "type": "integer",
      "minimum": 1,
      "maximum": 168,
      "default": 24
    },
    "urlAllowlist": {
      "title": "URL Allowlist (URLs with wildcards or Regex)",
      "description": "Array of URL patterns or regex patterns to allowlist URLs from detection. Supports simple URLs with * wildcards (e.g., https://google.com/*) or advanced regex patterns.",
      "type": "array",
      "items": {
        "type": "string",
        "title": "URL Pattern or Regex",
        "description": "URL with wildcards (e.g., https://google.com/*) or regular expression pattern to match URLs that should be allowlisted"
      },
      "default": []
    },
    "enableDebugLogging": {
      "title": "Debug Logging Enabled",
      "description": "Enable debug logging for troubleshooting",
      "type": "boolean",
      "default": false
    },
    "genericWebhook": {
      "title": "Generic Webhook",
      "description": "Generic webhook configuration for sending detection events to custom endpoint",
      "type": "object",
      "properties": {
        "enabled": {
          "title": "Enabled",
          "description": "Enable generic webhook",
          "type": "boolean",
          "default": false
        },
        "url": {
          "title": "Webhook URL",
          "description": "The URL to send webhook payloads to",
          "type": "string",
          "format": "uri",
          "default": ""
        },
        "events": {
          "title": "Event Types",
          "description": "Array of event types to send to this webhook",
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "detection_alert",
              "false_positive_report",
              "page_blocked",
              "rogue_app_detected",
              "threat_detected",
              "validation_event"
            ]
          },
          "default": []
        }
      }
    },
    "customBranding": {
      "title": "Custom Branding",
      "description": "Custom branding configuration for white labeling",
      "type": "object",
      "properties": {
        "companyName": {
          "title": "Company Name",
          "description": "Company name to display in the extension",
          "type": "string",
          "default": ""
        },
		"companyURL": {
          "title": "Company URL",
          "description": "Company URL used in the extension",
          "type": "string",
          "default": "https://cyberdrain.com/"
        },
        "productName": {
          "title": "Product Name",
          "description": "Custom name for the extension",
          "type": "string",
          "default": ""
        },
        "supportEmail": {
          "title": "Support Email",
          "description": "Email address for user support",
          "type": "string",
          "format": "email",
          "default": ""
        },
        "primaryColor": {
          "title": "Primary Color",
          "description": "Primary theme color (hex code)",
          "type": "string",
          "pattern": "^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$",
          "default": "#F77F00"
        },
        "logoUrl": {
          "title": "Logo URL",
          "description": "URL to company logo",
          "type": "string",
          "format": "uri",
          "default": ""
        }
      }
    },
    "domainSquatting": {
      "title": "Domain Squatting Detection",
      "description": "Configuration for domain squatting detection to protect against typosquatting, homoglyphs, and combosquatting attacks. Enable/disable is controlled by the detection rules JSON. Domains are automatically extracted from the URL allowlist.",
      "type": "object",
      "properties": {
        "deviationThreshold": {
          "title": "Deviation Threshold",
          "description": "Maximum number of character differences (Levenshtein distance) to trigger detection. Lower values are stricter.",
          "type": "integer",
          "minimum": 1,
          "maximum": 5,
          "default": 2
        },
        "algorithms": {
          "title": "Detection Algorithms",
          "description": "Enable or disable specific detection algorithms",
          "type": "object",
          "properties": {
            "levenshtein": {
              "title": "Levenshtein Distance",
              "description": "Detect domains with small character differences",
              "type": "boolean",
              "default": true
            },
            "homoglyph": {
              "title": "Homoglyph Detection",
              "description": "Detect confusable characters (e.g., 'a' vs 'Ð°')",
              "type": "boolean",
              "default": true
            },
            "typosquat": {
              "title": "Typosquatting Detection",
              "description": "Detect common typing mistakes and character swaps",
              "type": "boolean",
              "default": true
            },
            "combosquat": {
              "title": "Combosquatting Detection",
              "description": "Detect domains with added prefixes/suffixes",
              "type": "boolean",
              "default": true
            }
          }
        },
        "protectedDomains": {
          "title": "Additional Protected Domains",
          "description": "OPTIONAL: Additional domains to protect beyond those automatically extracted from the URL allowlist. Normally you should just add domains to the URL allowlist instead.",
          "type": "array",
          "items": {
            "type": "string",
            "title": "Domain",
            "description": "Domain name to protect (e.g., 'company.com')"
          },
          "default": []
        },
        "Action": {
          "title": "Action",
          "description": "Action to take when domain squatting is detected",
          "type": "string",
          "enum": ["block", "warn", "log"],
          "default": "block"
        },
        "logDetections": {
          "title": "Log Detections",
          "description": "Log all domain squatting detections to activity log",
          "type": "boolean",
          "default": true
        }
      }
    }
  }
}